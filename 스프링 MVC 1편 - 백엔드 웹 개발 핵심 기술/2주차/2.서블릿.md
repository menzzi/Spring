# ì„œë¸”ë¦¿

# **í”„ë¡œì íŠ¸ ìƒì„±**

# **Hello ì„œë¸”ë¦¿**

- @ServletComponentScan : ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” ì„œë¸”ë¦¿ì„ ì§ì ‘ ë“±ë¡í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡@ServletComponentScan ì„ ì§€ì›í•œë‹¤.
- @WebServlet ì„œë¸”ë¦¿ ì• ë…¸í…Œì´ì…˜ : name = ì„œë¸”ë¦¿ ì´ë¦„, urlPatterns = URL ë§¤í•‘ â†’ ì¤‘ë³µğŸš«

```java
@WebServlet(name = "helloServlet", urlPatterns = "/hello")
public class HelloServlet extends HttpServlet {
    @Override
    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {

        System.out.println("HelloServlet.service");

    }
}
```

[localhost:8080/hello](http://localhost:8080/hello) ë¡œ ë“¤ì–´ê°€ë©´ ë¹ˆí™”ë©´ì´ ëœ¨ê³  ì½˜ì†”ì°½ì—  HelloServlet.service ê°€ ëœ¬ë‹¤.

â†’ ì‘ë‹µí•œê²Œ ì—†ì–´ì„œ ì•„ì§ì€ ë¹ˆí™”ë©´

```java
@WebServlet(name = "helloServlet", urlPatterns = "/hello")
public class HelloServlet extends HttpServlet {
    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

        String username = request.getParameter("username");
        System.out.println("username = " + username);

        response.setContentType("text/plain");
        response.setCharacterEncoding("utf-8");
        response.getWriter().write("hello " + username);
    }
}
```

â†’ ì„œë¸”ë¦¿ ìš”ì²­,ì‘ë‹µ

[http://localhost:8080/hello?username=ë¯¼ì§€](http://localhost:8080/hello?username=%EB%AF%BC%EC%A7%80)ë¡œ ë“¤ì–´ê°€ë©´ hello ë¯¼ì§€ê°€ í™”ë©´ì— ì‘ë‹µë¨.

```java
logging.level.org.apache.coyote.http11=debug
```

ë‹¤ìŒ ì„¤ì •ì„ ì¶”ê°€í•˜ê³  ë‹¤ì‹œ ìš”ì²­í•´ë³´ë©´ ì„œë²„ê°€ ë°›ì€ HTTP ìš”ì²­ ë©”ì‹œì§€ë¥¼ ì¶œë ¥í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

í•˜ì§€ë§Œ ìš´ì˜ì„œë²„ì— ì´ë ‡ê²Œ ëª¨ë“  ìš”ì²­ ì •ë³´ë¥¼ ë‹¤ ë‚¨ê¸°ë©´ ì„±ëŠ¥ì €í•˜ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤. ê°œë°œ ë‹¨ê³„ì—ì„œë§Œ ì ìš©í•˜ì.

# **HttpServletRequest - ê°œìš”**

**HttpServletRequestê°€ ì¶”ê°€ë¡œ ì œê³µí•˜ëŠ” ê¸°ëŠ¥**

**â†’ ì„ì‹œ ì €ì¥ì†Œ ê¸°ëŠ¥**

í•´ë‹¹ HTTP ìš”ì²­ì´ ì‹œì‘ë¶€í„° ëë‚  ë•Œ ê¹Œì§€ ìœ ì§€ë˜ëŠ” ì„ì‹œ ì €ì¥ì†Œ ê¸°ëŠ¥
- ì €ì¥: request.setAttribute(name, value)
- ì¡°íšŒ: request.getAttribute(name)

â†’ **ì„¸ì…˜ ê´€ë¦¬ ê¸°ëŠ¥ :** ì´ì‚¬ëŒì´ ë¡œê·¸ì¸ì„ í–ˆë‹¤ ì•ˆ í–ˆë‹¤ ê¸°ë¡

request.getSession(create: true)

> ì¤‘ìš”!
HttpServletRequest, HttpServletResponseë¥¼ ì‚¬ìš©í•  ë•Œ ê°€ì¥ ì¤‘ìš”í•œ ì ì€ ì´ ê°ì²´ë“¤ì´ HTTP ìš”ì²­ ë©”ì‹œì§€, HTTP ì‘ë‹µ ë©”ì‹œì§€ë¥¼ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•˜ë„ë¡ ë„ì™€ì£¼ëŠ” ê°ì²´ë¼ëŠ” ì ì´ë‹¤. ë”°ë¼ì„œ ì´ ê¸°ëŠ¥ì— ëŒ€í•´ì„œ ê¹Šì´ìˆëŠ” ì´í•´ë¥¼ í•˜ë ¤ë©´ **HTTP ìŠ¤í™ì´ ì œê³µí•˜ëŠ” ìš”ì²­, ì‘ë‹µ ë©”ì‹œì§€ ìì²´ë¥¼ ì´í•´**í•´ì•¼ í•œë‹¤.
> 

# **HttpServletRequest - ê¸°ë³¸ ì‚¬ìš©ë²•**

# **HTTP ìš”ì²­ ë°ì´í„° - ê°œìš”**

HTTP ìš”ì²­ ë©”ì‹œì§€ë¥¼ í†µí•´ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ëŠ” ë°©ë²• (ì£¼ë¡œ ë‹¤ìŒ 3ê°€ì§€ ë°©ë²• ì‚¬ìš©)

1. **GET - ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°**
- /url**?username=hello&age=20**
- ë©”ì‹œì§€ ë°”ë”” ì—†ì´, URLì˜ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ì— ë°ì´í„°ë¥¼ í¬í•¨í•´ì„œ ì „ë‹¬
- ì˜ˆ) ê²€ìƒ‰, í•„í„°, í˜ì´ì§•ë“±ì—ì„œ ë§ì´ ì‚¬ìš©í•˜ëŠ” ë°©ì‹
****
1. **POST - HTML Form**
- content-type: application/x-www-form-urlencoded
- ë©”ì‹œì§€ ë°”ë””ì— ì¿¼ë¦¬ íŒŒë¦¬ë¯¸í„° í˜•ì‹ìœ¼ë¡œ ì „ë‹¬ username=hello&age=20
- ì˜ˆ) íšŒì› ê°€ì…, ìƒí’ˆ ì£¼ë¬¸, HTML Form ì‚¬ìš©

1. **HTTP message body**ì— ë°ì´í„°ë¥¼ ì§ì ‘ ë‹´ì•„ì„œ ìš”ì²­
- HTTP APIì—ì„œ ì£¼ë¡œ ì‚¬ìš©, JSON, XML, TEXT
- ë°ì´í„° í˜•ì‹ì€ ì£¼ë¡œ JSON ì‚¬ìš©
- POST, PUT, PATCH

# **HTTP ìš”ì²­ ë°ì´í„° - GET ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°**

ì „ë‹¬ ë°ì´í„°

- username=hello
- age=20

â†’ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ë¡œ ë‹¤ìŒ ë°ì´í„° ì „ì†¡ 

ë©”ì‹œì§€ ë°”ë”” ì—†ì´, URLì˜ **ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°**ë¥¼ ì‚¬ìš©í•´ì„œ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ì.

ì˜ˆ) ê²€ìƒ‰, í•„í„°, í˜ì´ì§•ë“±ì—ì„œ ë§ì´ ì‚¬ìš©í•˜ëŠ” ë°©ì‹

ì¿¼ë¦¬íŒŒë¼ë¯¸í„°ëŠ”URLì—ë‹¤ìŒê³¼ê°™ì´ ?ë¥¼ì‹œì‘ìœ¼ë¡œë³´ë‚¼ìˆ˜ìˆë‹¤.ì¶”ê°€íŒŒë¼ë¯¸í„°ëŠ” &ë¡œêµ¬ë¶„í•˜ë©´ëœë‹¤.

URL ë’¤ì— ?ë¡œ ì‹œì‘!!

[http://localhost:8080/request-param?username=hello&age=20](http://localhost:8080/request-param?username=hello&age=20)

<aside>
ğŸ—£ ë³µìˆ˜ íŒŒë¼ë¯¸í„° â†’ username=hello&username=kim ê³¼ ê°™ì´ íŒŒë¼ë¯¸í„° ì´ë¦„ì€ í•˜ë‚˜ì¸ë°, 
ê°’ì´ ì¤‘ë³µì´ë©´ ì–´ë–»ê²Œ ë ê¹Œ?

request.getParameter()ëŠ” í•˜ë‚˜ì˜ íŒŒë¼ë¯¸í„° ì´ë¦„ì— ëŒ€í•´ì„œ ë‹¨ í•˜ë‚˜ì˜ ê°’ë§Œ ìˆì„ ë•Œ ì‚¬ìš©í•´ì•¼ í•œë‹¤. ì§€ê¸ˆì²˜ëŸ¼ ì¤‘ë³µì¼ ë•ŒëŠ” request.getParameterValues()ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
ì°¸ê³ ë¡œ ì´ë ‡ê²Œ ì¤‘ë³µì¼ ë•Œ request.getParameter() ë¥¼ ì‚¬ìš©í•˜ë©´ request.getParameterValues() ì˜ ì²« ë²ˆì§¸ ê°’ì„ ë°˜í™˜í•œë‹¤.

ì¤‘ë³µìœ¼ë¡œ ë³´ë‚´ëŠ” ê²½ìš°ëŠ” ì˜ ì—†ë‹¤..!!

</aside>

# **HTTP ìš”ì²­ ë°ì´í„° - POST HTML Form**

**ìš”ì²­ URL**: http://localhost:8080/request-param

- **content-type**: application/x-www-form-urlencoded
- **message body**: username=hello&age=20

â†’ í´ë¼ì´ì–¸íŠ¸(ì›¹ ë¸Œë¼ìš°ì €) ì…ì¥ì—ì„œëŠ” ë‘ ë°©ì‹(GET,POST)ì— ì°¨ì´ê°€ ìˆì§€ë§Œ, ì„œë²„ ì…ì¥ì—ì„œëŠ” ë‘˜ì˜ í˜•ì‹ì´ ë™ì¼í•˜ë¯€ë¡œ, request.getParameter() ë¡œ í¸ë¦¬í•˜ê²Œ êµ¬ë¶„ì—†ì´ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.

= request.getParameter() ëŠ” GET URL ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° í˜•ì‹ë„ ì§€ì›í•˜ê³ , POST HTML Form í˜•ì‹ë„ ë‘˜ ë‹¤ ì§€ì›í•œë‹¤.

> ì°¸ê³ 
content-type : HTTP ë©”ì‹œì§€ ë°”ë””ì˜ ë°ì´í„° í˜•ì‹ì„ ì§€ì •
**GET URL ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° í˜•ì‹**ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•  ë•ŒëŠ” HTTP ë©”ì‹œì§€ ë°”ë””ë¥¼
> 
> 
> ì‚¬ìš©í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— content-typeì´ ì—†ë‹¤.
> **POST HTML Form í˜•ì‹**ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ë©´ HTTP ë©”ì‹œì§€ ë°”ë””ì— í•´ë‹¹ ë°ì´í„°ë¥¼ í¬í•¨í•´ì„œ ë³´ë‚´ê¸° ë•Œë¬¸ì— ë°”ë””ì— í¬í•¨ëœ ë°ì´í„°ê°€ ì–´ë–¤ í˜•ì‹ì¸ì§€ content-typeì„ ê¼­ ì§€ì •í•´ì•¼ í•œë‹¤. ì´ë ‡ê²Œ í¼ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì „ì†¡í•˜ëŠ” í˜•ì‹ì„ application/x-www-form-urlencoded ë¼ í•œë‹¤.
> 

# **HTTP ìš”ì²­ ë°ì´í„° - API ë©”ì‹œì§€ ë°”ë”” - ë‹¨ìˆœ í…ìŠ¤íŠ¸**

**ë¬¸ì ì „ì†¡** (postman ìœ¼ë¡œ í…ŒìŠ¤íŠ¸)

- POST http://localhost:8080/request-body-string
- content-type: text/plain
- message body: hello
- ê²°ê³¼: messageBody = hello

â†’ **ì°¸ê³ **> inputStreamì€ byte ì½”ë“œë¥¼ ë°˜í™˜í•œë‹¤. byte ì½”ë“œë¥¼ ìš°ë¦¬ê°€ ì½ì„ ìˆ˜ ìˆëŠ” ë¬¸ì(String)ë¡œ ë³´ë ¤ë©´ ë¬¸ìí‘œ (Charset)ë¥¼ ì§€ì •í•´ì£¼ì–´ì•¼ í•œë‹¤. ì—¬ê¸°ì„œëŠ” UTF_8 Charsetì„ ì§€ì •í•´ì£¼ì—ˆë‹¤.

```java
String messageBody = StreamUtils.copyToString(inputStream, StandardCharsets.UTF_8);
```

ğŸ“ŒÂ ë³´í†µì€ ë¬¸ìë³´ë‹¤ëŠ” JSON í˜•ì‹ìœ¼ë¡œ ì£¼ê³  ë°›ëŠ”ë‹¤!!!

# **HTTP ìš”ì²­ ë°ì´í„° - API ë©”ì‹œì§€ ë°”ë”” - JSON**

**JSON í˜•ì‹ ì „ì†¡**

- POST http://localhost:8080/request-body-json
- content-type: **application/json** (Body raw, ê°€ì¥ ì˜¤ë¥¸ìª½ì—ì„œ JSON ì„ íƒ)
- message body: {"username": "hello", "age": 20}
- ê²°ê³¼: messageBody = {"username": "hello", "age": 20}

- Getter,Setter (lombok ì œê³µ)
    
    ```java
    import lombok.Getter;
    import lombok.Setter;
    
    @Getter @Setter
    public class HelloData {
        private String username;
        private int age;
    }
    ```
    
    Getter,Setter ë©”ì„œë“œë¥¼ ë”°ë¡œ ì•ˆ ë§Œë“¤ê³  ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤!!(lombok ì œê³µ)
    

# **HttpServletResponse - ê¸°ë³¸ ì‚¬ìš©ë²•**

**HttpServletResponse ì—­í• **

- **HTTP ì‘ë‹µ ë©”ì‹œì§€ ìƒì„±**
    - HTTP ì‘ë‹µì½”ë“œ ì§€ì •
    - í—¤ë” ìƒì„±
    - ë°”ë”” ìƒì„±
- **í¸ì˜ ê¸°ëŠ¥ ì œê³µ**
    - Content-Type, ì¿ í‚¤, Redirect
        - ì½”ë“œ
            
            ```java
            private void content(HttpServletResponse response) {
                    //Content-Type: text/plain;charset=utf-8
                    //Content-Length: 2
                    //response.setHeader("Content-Type", "text/plain;charset=utf-8");
                    response.setContentType("text/plain");
                    response.setCharacterEncoding("utf-8");
                    //response.setContentLength(2); //(ìƒëµì‹œ ìë™ ìƒì„±)
                }
            ```
            
            ```java
            private void cookie(HttpServletResponse response) {
                    //Set-Cookie: myCookie=good; Max-Age=600;
                    // response.setHeader("Set-Cookie", "myCookie=good; Max-Age=600");
                    Cookie cookie = new Cookie("myCookie", "good");
                    cookie.setMaxAge(600); //600ì´ˆ
                    response.addCookie(cookie);
                }
            ```
            
            ```java
            private void redirect(HttpServletResponse response) throws IOException {
                    //Status Code 302
                    //Location: /basic/hello-form.html
                    //response.setStatus(HttpServletResponse.SC_FOUND); //302
                    //response.setHeader("Location", "/basic/hello-form.html");
                    response.sendRedirect("/basic/hello-form.html");
                }
            ```
            

# **HTTP ì‘ë‹µ ë°ì´í„° - ë‹¨ìˆœ í…ìŠ¤íŠ¸, HTML**

ë‹¨ìˆœ í…ìŠ¤íŠ¸ ì‘ë‹µ

ì•ì—ì„œ ì‚´í´ë´„ ( writer.println("ok"); )

HTML ì‘ë‹µ
HTTP API - MessageBody JSON ì‘ë‹µ

â†’ HTTP ì‘ë‹µìœ¼ë¡œ HTMLì„ ë°˜í™˜í•  ë•ŒëŠ” content-typeì„ text/html ë¡œ ì§€ì •í•´ì•¼ í•œë‹¤.

**ì‹¤í–‰**

- http://localhost:8080/response-html
- í˜ì´ì§€ ì†ŒìŠ¤ë³´ê¸°ë¥¼ ì‚¬ìš©í•˜ë©´ ê²°ê³¼ HTMLì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

# **HTTP ì‘ë‹µ ë°ì´í„° - API JSON**

HTTP ì‘ë‹µìœ¼ë¡œ JSONì„ ë°˜í™˜í•  ë•ŒëŠ” content-typeì„ application/json ë¡œ ì§€ì •í•´ì•¼ í•œë‹¤. 

Jackson ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì œê³µí•˜ëŠ” objectMapper.writeValueAsString() ë¥¼ ì‚¬ìš©í•˜ë©´ ê°ì²´ë¥¼ JSON ë¬¸ìë¡œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.